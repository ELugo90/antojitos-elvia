<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antojitos Elvia üåÆ - Sistema de Pedidos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: #f8f4ec;
            min-height: 100vh;
            padding: 1rem;
        }

        .app-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            background: transparent;
            padding: 0.5rem;
        }

        /* Header fijo */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
            background: white;
            padding: 0.8rem 1.5rem;
            border-radius: 60px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .logo-area {
            display: flex;
            align-items: center;
        }

        .logo-img {
            max-height: 50px;
            width: auto;
            object-fit: contain;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .admin-text {
            color: #4a5568;
            font-weight: 500;
            font-size: 0.95rem;
            cursor: pointer;
            text-decoration: underline dotted #e53e3e;
            transition: color 0.2s;
        }
        .admin-text:hover {
            color: #e53e3e;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.5rem;
            background: #f8fafc;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #e2e8f0;
            transition: all 0.2s;
        }
        .cart-icon:hover {
            border-color: #e53e3e;
        }
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e53e3e;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
        }

        /* Modal del carrito */
        .cart-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .cart-modal.show {
            display: flex;
        }
        .cart-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
        }
        .cart-modal-content h2 {
            font-size: 1.5rem;
            color: #1a1a1a;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid #e53e3e;
        }
        .cart-modal-items {
            list-style: none;
            margin-bottom: 1rem;
        }
        .cart-modal-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .cart-modal-item span:first-child {
            flex: 1;
            margin-right: 1rem;
            font-weight: 600;
            color: #1a1a1a;
            line-height: 1.4;
        }
        .cart-modal-item span:first-child::before {
            content: "‚Ä¢ ";
            color: #e53e3e;
            font-weight: bold;
        }

        /* Secci√≥n de propina */
        .propina-section {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 12px;
        }
        .propina-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .propina-header label {
            font-weight: 600;
            color: #4a5568;
        }
        .propina-input-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .propina-input-group input {
            flex: 1;
            padding: 0.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.95rem;
        }
        .propina-input-group input::placeholder {
            color: #a0aec0;
            font-style: italic;
        }
        .propina-input-group span {
            font-weight: 600;
            color: #4a5568;
        }

        .cart-modal-total {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e53e3e;
            text-align: right;
            margin: 1rem 0;
            padding-top: 0.5rem;
            border-top: 2px solid #e2e8f0;
        }

        /* Secci√≥n de pago */
        .pago-section {
            margin: 1rem 0;
        }
        .pago-field {
            margin-bottom: 0.5rem;
        }
        .pago-field label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: #4a5568;
            font-size: 0.9rem;
        }
        .pago-field input {
            width: 100%;
            padding: 0.6rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.95rem;
        }
        .pago-field input:focus {
            outline: none;
            border-color: #e53e3e;
        }
        .cambio-info {
            margin-top: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: #e53e3e;
            text-align: right;
        }

        /* Opciones de entrega */
        .entrega-opciones {
            margin-bottom: 1.5rem;
        }
        .entrega-opciones h3 {
            font-size: 1rem;
            color: #1a1a1a;
            margin-bottom: 0.8rem;
        }
        .radio-group {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.95rem;
        }
        .radio-group input[type="radio"] {
            width: 1rem;
            height: 1rem;
            accent-color: #e53e3e;
        }

        .cart-modal-field {
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        .cart-modal-field.hidden {
            display: none;
        }
        .cart-modal-field label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: #4a5568;
            font-size: 0.9rem;
        }
        .cart-modal-field input,
        .cart-modal-field textarea {
            width: 100%;
            padding: 0.6rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.9rem;
        }
        .cart-modal-field input:focus,
        .cart-modal-field textarea:focus {
            outline: none;
            border-color: #e53e3e;
        }

        .cart-modal-buttons {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.5rem;
        }
        .cart-modal-buttons button {
            flex: 1;
            background: #e53e3e;
            border: none;
            color: white;
            font-weight: 600;
            padding: 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .cart-modal-buttons button:last-child {
            background: white;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        /* Modal de contrase√±a */
        .password-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .password-modal.show {
            display: flex;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            max-width: 350px;
            width: 90%;
            text-align: center;
        }
        .modal-content h3 {
            color: #1a1a1a;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        .modal-content input {
            width: 100%;
            padding: 0.8rem;
            font-size: 0.95rem;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            margin-bottom: 1rem;
        }
        .modal-buttons {
            display: flex;
            gap: 0.8rem;
            justify-content: center;
        }
        .modal-buttons button {
            background: #e53e3e;
            border: none;
            color: white;
            font-weight: 600;
            padding: 0.6rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .modal-buttons button:last-child {
            background: white;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        /* Panel de administraci√≥n */
        .admin-panel {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 2px solid #e2e8f0;
            display: none;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }
        .admin-panel.show {
            display: block;
        }
        .admin-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.8rem;
        }
        .admin-tab {
            background: none;
            border: none;
            color: #4a5568;
            font-weight: 500;
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            cursor: pointer;
        }
        .admin-tab.active {
            background: #e53e3e;
            color: white;
        }
        .admin-category {
            display: none;
        }
        .admin-category.active {
            display: block;
        }
        .admin-list {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }
        .admin-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.6rem;
            border-bottom: 1px solid #e2e8f0;
        }
        .admin-item:last-child {
            border-bottom: none;
        }
        .admin-item label {
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }
        .admin-item input[type="checkbox"] {
            width: 1rem;
            height: 1rem;
        }
        .item-controls button {
            background: none;
            border: none;
            color: #e53e3e;
            font-size: 0.85rem;
            cursor: pointer;
            padding: 0.3rem 0.6rem;
        }
        .admin-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .admin-actions button {
            background: #e53e3e;
            border: none;
            color: white;
            font-weight: 500;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        .admin-add-form {
            display: flex;
            gap: 0.8rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .admin-add-form input {
            flex: 1;
            padding: 0.6rem;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            font-size: 0.85rem;
        }
        .admin-add-form button {
            background: #48bb78;
            border: none;
            color: white;
            font-weight: 500;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.85rem;
        }

        /* Contenido principal */
        .main-content {
            width: 100%;
        }

        .flow-section {
            width: 100%;
            min-height: auto;
            display: flex;
            flex-direction: column;
        }

        .screen {
            display: none;
            flex-direction: column;
        }
        .screen.active {
            display: flex;
        }

        .screen h2 {
            font-size: 1.4rem;
            color: #1a1a1a;
            margin-bottom: 1rem;
            font-weight: 600;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e53e3e;
        }

        /* Grid de productos */
        .productos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.8rem;
            margin-bottom: 1rem;
        }
        .producto-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 20px;
            padding: 1rem 0.5rem;
            text-align: center;
            font-weight: 600;
            font-size: 0.95rem;
            color: #1a1a1a;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 6px rgba(0,0,0,0.02);
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        .producto-card:hover {
            border-color: #e53e3e;
            transform: translateY(-2px);
        }
        .producto-card .precio {
            color: #e53e3e;
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Modal de complementos */
        .complementos-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        .complementos-modal.show {
            display: flex;
        }
        .complementos-content {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .complementos-content h3 {
            font-size: 1.3rem;
            color: #1a1a1a;
            margin-bottom: 1rem;
        }
        .complementos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.8rem;
            margin: 1.5rem 0;
        }
        .complemento-item {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            padding: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        .complemento-item input {
            width: 1rem;
            height: 1rem;
            accent-color: #e53e3e;
        }
        .complemento-item span {
            font-size: 0.9rem;
            font-weight: 500;
        }
        .cantidad-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .cantidad-selector button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #e53e3e;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        .cantidad-selector span {
            font-size: 1.5rem;
            font-weight: 600;
            min-width: 50px;
            text-align: center;
        }

        footer {
            text-align: center;
            color: #718096;
            margin-top: 2rem;
            font-size: 0.8rem;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .header {
                padding: 0.6rem 1rem;
            }
            .productos-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
<div class="app-wrapper">
    <!-- Header fijo -->
    <div class="header">
        <div class="logo-area">
            <img src="logo.png" alt="Antojitos Elvia" class="logo-img" onerror="this.src='https://via.placeholder.com/150x50?text=Antojitos+Elvia'">
        </div>
        <div class="header-right">
            <span class="admin-text" id="adminToggleBtn">Administrador</span>
            <div class="cart-icon" id="cartIcon">
                üõí
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </div>
    </div>

    <!-- Modal de contrase√±a -->
    <div id="passwordModal" class="password-modal">
        <div class="modal-content">
            <h3>Acceso Administrador</h3>
            <input type="password" id="adminPassword" placeholder="Contrase√±a">
            <div class="modal-buttons">
                <button id="submitPassword">Entrar</button>
                <button id="cancelPassword">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de complementos -->
    <div id="complementosModal" class="complementos-modal">
        <div class="complementos-content">
            <h3 id="complementosTitle">Personaliza tu pedido</h3>
            <div id="complementosContainer" class="complementos-grid"></div>
            
            <div class="cantidad-selector">
                <button id="cantidadMenos">-</button>
                <span id="cantidadValue">1</span>
                <button id="cantidadMas">+</button>
            </div>
            
            <div class="cart-modal-buttons">
                <button id="agregarAlCarrito">Agregar al carrito</button>
                <button id="cerrarComplementos">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal del carrito -->
    <div id="cartModal" class="cart-modal">
        <div class="cart-modal-content">
            <h2>üõí Mi pedido</h2>
            <ul id="cartModalItems" class="cart-modal-items"></ul>
            
            <!-- Propina -->
            <div class="propina-section">
                <div class="propina-header">
                    <label>üíù Propina</label>
                </div>
                <div class="propina-input-group">
    <span style="font-weight:600; color:#e53e3e; margin-right:0.25rem;">$</span>
    <input type="number" id="propinaInput" placeholder="10% sugerido" min="0" step="10" style="flex:1;">
    <span>MXN</span>
</div>
            </div>
            
            <div class="cart-modal-total" id="cartModalTotal">Total: $0</div>
            
            <!-- Pago -->
            <div class="pago-section">
                <div class="pago-field">
                    <label>üí∞ ¬øCon cu√°nto pagas?</label>
                    <input type="number" id="pagoInput" value="0" min="0" step="10">
                </div>
                <div class="cambio-info" id="cambioInfo">Cambio: $0</div>
            </div>
            
            <div class="entrega-opciones">
                <h3>üìç Opci√≥n de entrega</h3>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="tipoEntrega" value="recoger" id="recogerRadio" checked>
                        Recoger en sitio
                    </label>
                    <label>
                        <input type="radio" name="tipoEntrega" value="domicilio" id="domicilioRadio">
                        Entrega a domicilio
                    </label>
                </div>
            </div>
            
            <div class="cart-modal-field hidden" id="direccionField">
                <label>üìç Direcci√≥n completa:</label>
                <input type="text" id="customerAddress" placeholder="Calle, n√∫mero, colonia, referencia">
            </div>
            
            <div class="cart-modal-field">
                <label>üë§ Nombre:</label>
                <input type="text" id="customerName" placeholder="Ej: Juan P√©rez">
            </div>
            
            <div class="cart-modal-field">
                <label>üí¨ Comentarios:</label>
                <textarea id="customerComments" rows="2" placeholder="¬øAlguna indicaci√≥n?"></textarea>
            </div>
            
            <div class="cart-modal-buttons">
                <button id="confirmCart">Confirmar pedido</button>
                <button id="closeCartModal">Seguir comprando</button>
            </div>
        </div>
    </div>

    <!-- Panel de administraci√≥n -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-tabs">
            <button class="admin-tab active" data-admin-cat="productos">üåÆ Productos</button>
            <button class="admin-tab" data-admin-cat="complementos">üßÖ Complementos</button>
        </div>

        <div id="admin-productos" class="admin-category active">
            <div class="admin-list" id="productosAdminList"></div>
            <div class="admin-actions">
                <button id="addProductoBtn">‚ûï Agregar</button>
                <button id="deleteProductosBtn">üóëÔ∏è Eliminar</button>
            </div>
            <div class="admin-add-form">
                <input type="text" id="newProductoNombre" placeholder="Nombre">
                <input type="number" id="newProductoPrecio" placeholder="Precio">
                <select id="newProductoTipo">
                    <option value="normal">Normal</option>
                    <option value="carne">Con carne</option>
                    <option value="guisado">Con guisado</option>
                    <option value="sencillo">Sencillo</option>
                </select>
                <button id="saveProductoBtn">Guardar</button>
            </div>
        </div>

        <div id="admin-complementos" class="admin-category">
            <div class="admin-list" id="complementosAdminList"></div>
            <div class="admin-actions">
                <button id="addComplementoBtn">‚ûï Agregar</button>
                <button id="deleteComplementosBtn">üóëÔ∏è Eliminar</button>
            </div>
            <div class="admin-add-form">
                <input type="text" id="newComplementoNombre" placeholder="Ej: Cebolla">
                <select id="newComplementoCategoria">
                    <option value="Quesadilla">Quesadilla</option>
                    <option value="Gordita">Gordita</option>
                    <option value="Huarache">Huarache</option>
                    <option value="Tostada">Tostada</option>
                    <option value="Pambazo">Pambazo</option>
                    <option value="Taco">Taco</option>
                    <option value="Sope">Sope</option>
                </select>
                <button id="saveComplementoBtn">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Contenido principal -->
    <div class="main-content">
        <div class="flow-section">
            <!-- Pantalla √∫nica: Productos -->
            <div id="screenMenu" class="screen active">
                <h2>¬øQu√© se te antoja? üåÆ</h2>
                <div class="productos-grid" id="productosGrid"></div>
            </div>
        </div>
    </div>
    <footer>Antojitos Elvia ¬© 2026</footer>
</div>

<script>
    (function() {
        // ========== DATOS ==========
        const complementosPorProducto = {
            'Quesadilla': ['Lechuga', 'Queso', 'Crema', 'Salsa verde', 'Salsa roja'],
            'Gordita': ['Cebolla', 'Cilantro', 'Lechuga', 'Nopales', 'Queso', 'Salsa verde', 'Salsa roja'],
            'Huarache': ['Cebolla', 'Cilantro', 'Queso', 'Lechuga', 'Nopales', 'Salsa verde', 'Salsa roja'],
            'Tostada': ['Lechuga', 'Queso', 'Crema', 'Salsa verde', 'Salsa roja'],
            'Pambazo': ['Lechuga', 'Queso', 'Crema', 'Salsa verde', 'Salsa roja'],
            'Taco': ['Cebolla', 'Cilantro', 'Salsa verde', 'Salsa roja'],
            'Sope': ['Lechuga', 'Queso', 'Crema', 'Cebolla', 'Cilantro', 'Salsa verde', 'Salsa roja']
        };

        // Productos ordenados alfab√©ticamente (excepto bebidas al final)
        let productos = [
            // Gorditas
            { nombre: 'Gordita', precio: 40, tipo: 'carne', descripcion: 'c/Carne' },
            { nombre: 'Gordita', precio: 30, tipo: 'guisado', descripcion: 'c/Guisado' },
            
            // Huaraches
            { nombre: 'Huarache', precio: 70, tipo: 'carne', descripcion: 'c/Carne' },
            { nombre: 'Huarache', precio: 60, tipo: 'guisado', descripcion: 'c/Guisado' },
            { nombre: 'Huarache', precio: 45, tipo: 'sencillo', descripcion: 'Sencillo' },
            
            // Pambazo
            { nombre: 'Pambazo', precio: 30, tipo: 'normal' },
            
            // Quesadilla
            { nombre: 'Quesadilla', precio: 30, tipo: 'normal' },
            
            // Sopes
            { nombre: 'Sope', precio: 40, tipo: 'carne', descripcion: 'c/Carne' },
            { nombre: 'Sope', precio: 30, tipo: 'guisado', descripcion: 'c/Guisado' },
            
            // Tacos
            { nombre: 'Taco', precio: 30, tipo: 'normal' },
            
            // Tostada
            { nombre: 'Tostada', precio: 30, tipo: 'normal' },
            
            // Bebidas (siempre al final)
            { nombre: 'Coca-Cola 500ml', precio: 28, tipo: 'bebida' },
            { nombre: 'Jarrito 600ml', precio: 23, tipo: 'bebida' }
        ];

        let carrito = [];
        let productoSeleccionado = null;
        let cantidadSeleccionada = 1;
        let adminActivo = false;

        // ========== FUNCIONES ==========
        function renderProductos() {
            const grid = document.getElementById('productosGrid');
            grid.innerHTML = '';

            productos.forEach((prod, index) => {
                const card = document.createElement('div');
                card.className = 'producto-card';
                card.dataset.index = index;
                
                let nombreMostrar = prod.nombre;
                if (prod.descripcion) {
                    nombreMostrar += ' ' + prod.descripcion;
                } else if (prod.tipo === 'carne') {
                    nombreMostrar += ' c/Carne';
                } else if (prod.tipo === 'guisado') {
                    nombreMostrar += ' c/Guisado';
                }
                
                card.innerHTML = `
                    <span>${nombreMostrar}</span>
                    <span class="precio">$${prod.precio}</span>
                `;
                
                card.addEventListener('click', () => {
                    if (prod.tipo === 'bebida') {
                        // Las bebidas se agregan directo
                        for (let i = 0; i < cantidadSeleccionada; i++) {
                            carrito.push({ 
                                nombre: prod.nombre, 
                                precio: prod.precio 
                            });
                        }
                        updateCartCount();
                    } else {
                        // Abrir modal de complementos
                        productoSeleccionado = prod;
                        cantidadSeleccionada = 1;
                        document.getElementById('cantidadValue').textContent = '1';
                        abrirComplementos(prod.nombre);
                    }
                });
                
                grid.appendChild(card);
            });
        }

        function abrirComplementos(nombreProducto) {
            const container = document.getElementById('complementosContainer');
            const title = document.getElementById('complementosTitle');
            
            // Obtener complementos espec√≠ficos del producto
            let complementos = [];
            if (nombreProducto.includes('Quesadilla')) {
                complementos = complementosPorProducto.Quesadilla;
            } else if (nombreProducto.includes('Gordita')) {
                complementos = complementosPorProducto.Gordita;
            } else if (nombreProducto.includes('Huarache')) {
                complementos = complementosPorProducto.Huarache;
            } else if (nombreProducto.includes('Tostada')) {
                complementos = complementosPorProducto.Tostada;
            } else if (nombreProducto.includes('Pambazo')) {
                complementos = complementosPorProducto.Pambazo;
            } else if (nombreProducto.includes('Taco')) {
                complementos = complementosPorProducto.Taco;
            } else if (nombreProducto.includes('Sope')) {
                complementos = complementosPorProducto.Sope;
            }
            
            title.textContent = `Personaliza tu ${nombreProducto}`;
            
            container.innerHTML = '';
            complementos.forEach(comp => {
                const label = document.createElement('label');
                label.className = 'complemento-item';
                label.innerHTML = `
                    <input type="checkbox" class="complemento-check" checked>
                    <span>${comp}</span>
                `;
                container.appendChild(label);
            });
            
            document.getElementById('complementosModal').classList.add('show');
        }

        // Eventos de cantidad
        document.getElementById('cantidadMas').addEventListener('click', () => {
            cantidadSeleccionada++;
            document.getElementById('cantidadValue').textContent = cantidadSeleccionada;
        });
        
        document.getElementById('cantidadMenos').addEventListener('click', () => {
            if (cantidadSeleccionada > 1) {
                cantidadSeleccionada--;
                document.getElementById('cantidadValue').textContent = cantidadSeleccionada;
            }
        });

        document.getElementById('agregarAlCarrito').addEventListener('click', () => {
            if (!productoSeleccionado) return;

            const complementos = [];
            document.querySelectorAll('.complemento-check:checked').forEach(cb => {
                complementos.push(cb.nextElementSibling.textContent);
            });

            const complementosStr = complementos.length ? ' con ' + complementos.join(', ') : '';

            for (let i = 0; i < cantidadSeleccionada; i++) {
                let nombre = productoSeleccionado.nombre;
                if (productoSeleccionado.descripcion) {
                    nombre += ' ' + productoSeleccionado.descripcion;
                } else if (productoSeleccionado.tipo === 'carne') {
                    nombre += ' c/Carne';
                } else if (productoSeleccionado.tipo === 'guisado') {
                    nombre += ' c/Guisado';
                }
                nombre += complementosStr;
                
                carrito.push({
                    nombre: nombre,
                    precio: productoSeleccionado.precio
                });
            }

            updateCartCount();
            document.getElementById('complementosModal').classList.remove('show');
            productoSeleccionado = null;
        });

        document.getElementById('cerrarComplementos').addEventListener('click', () => {
            document.getElementById('complementosModal').classList.remove('show');
            productoSeleccionado = null;
        });

        function updateCartCount() {
            document.getElementById('cartCount').textContent = carrito.length;
        }

        // ========== MODAL DEL CARRITO ==========
        const cartModal = document.getElementById('cartModal');
        const cartIcon = document.getElementById('cartIcon');
        const propinaInput = document.getElementById('propinaInput');
        const pagoInput = document.getElementById('pagoInput');
        const cambioInfo = document.getElementById('cambioInfo');
        
        function calcularSubtotal() {
            return carrito.reduce((acc, i) => acc + i.precio, 0);
        }

        function calcularPropina() {
    const valor = propinaInput.value;
    
    // Si el usuario escribi√≥ algo, usar ese valor
    if (valor !== '' && !isNaN(parseFloat(valor))) {
        return parseFloat(valor);
    }
    
    // Si est√° vac√≠o, calcular 10% del subtotal
    const subtotal = calcularSubtotal();
    const diezPorciento = Math.round(subtotal * 0.1);
    
    // Mostrar el 10% como placeholder pero NO agregarlo al total
    propinaInput.placeholder = `$${diezPorciento} (10%)`;
    return 0; // Importante: retornar 0 cuando est√° vac√≠o
}

        function calcularTotal() {
            return calcularSubtotal() + calcularPropina();
        }

        function actualizarTotalYCambio() {
    const subtotal = calcularSubtotal();
    const propina = calcularPropina();
    const total = subtotal + propina;
    
    document.getElementById('cartModalTotal').textContent = `Total: $${total}`;
    
    const pago = parseFloat(pagoInput.value) || 0;
    const cambio = pago - total;
    cambioInfo.textContent = `Cambio: $${cambio >= 0 ? cambio : 0}`;
}

        function renderCartModal() {
            const itemsList = document.getElementById('cartModalItems');
            
            if (carrito.length === 0) {
                itemsList.innerHTML = '<li style="text-align:center; color:#718096; padding:1rem 0;">Carrito vac√≠o</li>';
                document.getElementById('cartModalTotal').textContent = 'Total: $0';
                return;
            }

            let html = '';
            carrito.forEach((item, idx) => {
                html += `<li class="cart-modal-item">
                    <span>${item.nombre}</span>
                    <span>
                        $${item.precio}
                        <button style="background:#e53e3e; border:none; color:white; width:22px; height:22px; border-radius:50%; cursor:pointer; margin-left:0.5rem;" onclick="eliminarDelCarrito(${idx})">‚úï</button>
                    </span>
                </li>`;
            });
            itemsList.innerHTML = html;
            
            actualizarTotalYCambio();
        }

        window.eliminarDelCarrito = (idx) => {
            carrito.splice(idx, 1);
            updateCartCount();
            renderCartModal();
        };

        propinaInput.addEventListener('input', actualizarTotalYCambio);
        pagoInput.addEventListener('input', actualizarTotalYCambio);

        // Opciones de entrega
        const recogerRadio = document.getElementById('recogerRadio');
        const domicilioRadio = document.getElementById('domicilioRadio');
        const direccionField = document.getElementById('direccionField');

        function toggleDireccionField() {
            if (domicilioRadio.checked) {
                direccionField.classList.remove('hidden');
            } else {
                direccionField.classList.add('hidden');
            }
        }

        recogerRadio.addEventListener('change', toggleDireccionField);
        domicilioRadio.addEventListener('change', toggleDireccionField);

        cartIcon.addEventListener('click', () => {
            renderCartModal();
            cartModal.classList.add('show');
            recogerRadio.checked = true;
            toggleDireccionField();
            propinaInput.value = '';
            pagoInput.value = '0';
            actualizarTotalYCambio();
        });

        document.getElementById('closeCartModal').addEventListener('click', () => {
            cartModal.classList.remove('show');
        });

        function reiniciarPedido() {
            carrito = [];
            updateCartCount();
        }

        document.getElementById('confirmCart').addEventListener('click', () => {
            if (carrito.length === 0) {
                alert('Carrito vac√≠o');
                return;
            }

            const nombre = document.getElementById('customerName').value.trim();
            
            if (!nombre) {
                alert('Ingresa tu nombre');
                return;
            }

            if (domicilioRadio.checked) {
                const direccion = document.getElementById('customerAddress').value.trim();
                if (!direccion) {
                    alert('Ingresa la direcci√≥n de entrega');
                    return;
                }
            }

            const subtotal = calcularSubtotal();
            const propina = calcularPropina();
            const total = subtotal + propina;
            const pago = parseFloat(pagoInput.value) || 0;
            
            if (pago < total) {
                alert('El pago es insuficiente');
                return;
            }

            let msg = "üçΩÔ∏è *Pedido Antojitos Elvia* üçΩÔ∏è%0A%0A";
            msg += `üë§ *Nombre:* ${nombre}%0A`;
            
            if (domicilioRadio.checked) {
                const direccion = document.getElementById('customerAddress').value.trim();
                msg += `üìç *Direcci√≥n:* ${direccion}%0A`;
                msg += `üöö *Tipo:* Entrega a domicilio%0A`;
            } else {
                msg += `üìç *Tipo:* Recoger en sitio%0A`;
            }
            
            msg += `%0A*Pedido:*%0A`;
            
            carrito.forEach(i => msg += `‚Ä¢ ${i.nombre}: $${i.precio}%0A`);
            
            msg += `%0A*Subtotal: $${subtotal}*%0A`;
            if (propina > 0) {
                msg += `*Propina: $${propina}*%0A`;
            }
            msg += `*TOTAL: $${total}*%0A`;
            
            msg += `*Paga con: $${pago}*%0A`;
            msg += `*Cambio: $${pago - total}*%0A`;
            
            const coment = document.getElementById('customerComments').value.trim();
            if (coment) msg += `%0Aüìù *Comentarios:* ${coment}%0A`;
            
            window.open(`https://wa.me/5613647545?text=${msg}`, '_blank');
            
            reiniciarPedido();
            cartModal.classList.remove('show');
            
            document.getElementById('customerName').value = '';
            document.getElementById('customerAddress').value = '';
            document.getElementById('customerComments').value = '';
            recogerRadio.checked = true;
            toggleDireccionField();
        });

        // ========== ADMIN ==========
        const modal = document.getElementById('passwordModal');
        const adminPanel = document.getElementById('adminPanel');
        const adminBtn = document.getElementById('adminToggleBtn');
        
        adminBtn.addEventListener('click', () => {
            if (adminActivo) {
                adminActivo = false;
                adminPanel.classList.remove('show');
            } else {
                modal.classList.add('show');
            }
        });

        document.getElementById('submitPassword').addEventListener('click', () => {
            const pass = document.getElementById('adminPassword').value;
            if (pass === 'Elvialogar') {
                modal.classList.remove('show');
                adminActivo = true;
                adminPanel.classList.add('show');
                renderAdminLists();
            } else {
                alert('Contrase√±a incorrecta');
            }
        });

        document.getElementById('cancelPassword').addEventListener('click', () => {
            modal.classList.remove('show');
        });

        // Tabs de admin
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                document.querySelectorAll('.admin-category').forEach(c => c.classList.remove('active'));
                document.getElementById(`admin-${tab.dataset.adminCat}`).classList.add('active');
            });
        });

        function renderAdminLists() {
            const prodList = document.getElementById('productosAdminList');
            prodList.innerHTML = '';
            productos.forEach((prod, idx) => {
                prodList.innerHTML += `
                    <div class="admin-item">
                        <label><input type="checkbox" class="prod-check" value="${idx}"> ${prod.nombre} ${prod.descripcion || ''} - $${prod.precio}</label>
                        <div class="item-controls"><button onclick="editarProducto(${idx})">‚úèÔ∏è</button></div>
                    </div>
                `;
            });

            const compList = document.getElementById('complementosAdminList');
            compList.innerHTML = '';
            // Mostrar complementos agrupados por producto
            for (let [producto, comps] of Object.entries(complementosPorProducto)) {
                comps.forEach((comp, idx) => {
                    compList.innerHTML += `
                        <div class="admin-item">
                            <label>${producto}: ${comp}</label>
                        </div>
                    `;
                });
            }
        }

        window.editarProducto = (idx) => {
            const nuevoPrecio = prompt('Nuevo precio:', productos[idx].precio);
            if (nuevoPrecio) {
                productos[idx].precio = parseFloat(nuevoPrecio);
                renderAdminLists();
                renderProductos();
            }
        };

        document.getElementById('saveProductoBtn').addEventListener('click', () => {
            const nombre = document.getElementById('newProductoNombre').value.trim();
            const precio = parseFloat(document.getElementById('newProductoPrecio').value);
            const tipo = document.getElementById('newProductoTipo').value;
            
            if (nombre && !isNaN(precio)) {
                let nuevoProducto = { nombre, precio, tipo };
                if (tipo === 'carne') nuevoProducto.descripcion = 'c/Carne';
                if (tipo === 'guisado') nuevoProducto.descripcion = 'c/Guisado';
                if (tipo === 'sencillo') nuevoProducto.descripcion = 'Sencillo';
                
                productos.push(nuevoProducto);
                renderAdminLists();
                renderProductos();
            }
        });

        document.getElementById('saveComplementoBtn').addEventListener('click', () => {
            const nombre = document.getElementById('newComplementoNombre').value.trim();
            const categoria = document.getElementById('newComplementoCategoria').value;
            
            if (nombre && categoria) {
                if (!complementosPorProducto[categoria]) {
                    complementosPorProducto[categoria] = [];
                }
                complementosPorProducto[categoria].push(nombre);
                renderAdminLists();
            }
        });

        document.getElementById('deleteProductosBtn').addEventListener('click', () => {
            const checks = document.querySelectorAll('.prod-check:checked');
            const indices = [...checks].map(c => parseInt(c.value)).sort((a,b) => b-a);
            indices.forEach(i => productos.splice(i, 1));
            renderAdminLists();
            renderProductos();
        });

        // ========== INICIALIZACI√ìN ==========
        renderProductos();
        updateCartCount();
    })();
</script>
</body>
</html>
